<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="信笺叶子" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="zonectmac 博客">
<meta property="og:type" content="website">
<meta property="og:title" content="信笺叶子">
<meta property="og:url" content="http://zonectmac.com/index.html">
<meta property="og:site_name" content="信笺叶子">
<meta property="og:description" content="zonectmac 博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="信笺叶子">
<meta name="twitter:description" content="zonectmac 博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: 'OEP7UP6GTS',
      apiKey: '30795d859e1f1a85c0b2bddec13d88fa',
      indexName: 'first_NAME',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://zonectmac.com/"/>





  <title> 信笺叶子 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4fbac29505b4018228f94fac6c51bf94";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">信笺叶子</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">哈哈哈Camera</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://zonectmac.com/2017/04/22/send-email/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZonecTmac">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="信笺叶子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/22/send-email/" itemprop="url">
                  实现发送邮箱的几种方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-22T00:18:11+08:00">
                2017-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>以下为众多方法中的几种，后面继续补充。。。。。</p>
</blockquote>
<h3 id="一、telnet-windows下使用cmd（命令行）发送邮件"><a href="#一、telnet-windows下使用cmd（命令行）发送邮件" class="headerlink" title="一、telnet windows下使用cmd（命令行）发送邮件"></a>一、telnet windows下使用cmd（命令行）发送邮件</h3><h5 id="1、windows开启telnet服务"><a href="#1、windows开启telnet服务" class="headerlink" title="　　1、windows开启telnet服务"></a>　　1、windows开启telnet服务</h5><p>　　 打开控制面板，找到“打开或关闭windows功能”（在“程序”里面），选中对话框中的Telnet客户端、Telnet服务器（可能不需要，没测试），然后确定，等待  完成。这时就开启了telnet功能。</p>
<h5 id="2、开始发送邮件"><a href="#2、开始发送邮件" class="headerlink" title="　　2、开始发送邮件"></a>　　2、开始发送邮件</h5><blockquote>
<p>（发送邮件过程中不要长时间不操作命令行窗口，超过一定时间不操作的话服务器主机会主动断开连接，命令行窗口提示“遗失对主机的连接”）</p>
</blockquote>
<p> 　　<strong>1）打开命令行窗口，连接邮件服务器</strong><br>　　在命令刚窗口输入 telnet smtp.qq.com 25(这里以qq为例，若是163，则是smtp.163.com,25是端口　号，一般情况下不会变)<br>　　如果连接成功，服务器会返回一串字符：220 smtp.qq.com Esmtp QQ Mail Server<br>　　<strong> 2）向服务器表明身份</strong><br>　　在命令行输入 helo qq.com如果成功，服务器返回 250 smtp.qq.com<br>(qq.com可以用任何合法字符代替，本人用的名字拼音也通过了)<br>　　<strong> 3）登录认证</strong><br>　　 在命令行窗口输入 auth login如果成功，服务器会返回一串字符，类似于：334 VXNlcm5hbWU6，<br>　　（334 是不变的，后面的字母可能会变）<br> 　　接着输入你的邮箱（xxxxx@qq.com）的base64编码之后的字符串然后回车<br>　　如果成功，服务器返回一串字符，类似于：334 UGFzc3dvcmQ6<br>　　（334 是不变的，后面的字母可能会变）<br>　　接着输入你的独立密码（注意是独立密码）的base64编码之后的字符串然后回车，<br>　　如果登录成功，服务器返回一串字符：235 Authentication successful，<br>表示登录成功，如果不能成功登录，请检查账号密码是否正确。<br>　　  <strong>4）编写邮件</strong><br>　　输入 mail from:＜<a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#111;&#x3a;&#x4f60;&#x81ea;&#24049;&#30340;&#x90ae;&#x7bb1;&#xff0c;&#x5c31;&#x662f;&#x4e0a;&#x4e00;&#27493;&#30340;&#30331;&#x5f55;&#x90ae;&#31665;&#x78;&#x78;&#x78;&#x40;&#113;&#113;&#x2e;&#99;&#111;&#x6d;">&#x4f60;&#x81ea;&#24049;&#30340;&#x90ae;&#x7bb1;&#xff0c;&#x5c31;&#x662f;&#x4e0a;&#x4e00;&#27493;&#30340;&#30331;&#x5f55;&#x90ae;&#31665;&#x78;&#x78;&#x78;&#x40;&#113;&#113;&#x2e;&#99;&#111;&#x6d;</a>＞ 回车<br>  　　（冒号和尖括号均为因为半角标点符号）<br>　　若格式不正确，服务器返回501 错误；若格式正确，服务器返回250 Ok。<br>　　输入 rcpt to:＜<a href="&#109;&#x61;&#105;&#x6c;&#x74;&#111;&#x3a;&#x6536;&#x4ef6;&#x4eba;&#37038;&#x7bb1;&#65292;&#x78;&#120;&#x78;&#64;&#120;&#x78;&#x78;&#x2e;&#120;&#x78;&#120;">&#x6536;&#x4ef6;&#x4eba;&#37038;&#x7bb1;&#65292;&#x78;&#120;&#x78;&#64;&#120;&#x78;&#x78;&#x2e;&#120;&#x78;&#120;</a> ＞回车<br>　　若格式不正确，服务器返回501错误；若格式正确，服务器返回250 Ok。<br>　　输入data 回车<br>　　 服务器返回 354 End data with <cr><lf>.<cr><lf><br>　　输入from:名字 回车，<br>　　显示在收件人收邮件时的 发件人 位置<br>　　输入 to:名字 回车，<br>　　显示收件人收邮件时的 收件人 位置<br>　　输入 subject:主题 回车，<br>　　邮件主题<br>　　空一行写邮件内容，写完之后换行，输入英文半角状态下的句号 . 表示邮件内容写完了（不要问我正文中如果包含英文半角状态下的句号怎么办）<br>　　服务器返回 250 Ok: queues as<br>　　表示邮件已经发送<br>如 图：<br>　　<br><img src="http://upload-images.jianshu.io/upload_images/2953420-ddb49e1951cee355.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></lf></cr></lf></cr></p>
<h3 id="二、vbScript-发送邮件"><a href="#二、vbScript-发送邮件" class="headerlink" title="二、vbScript 发送邮件"></a>二、vbScript 发送邮件</h3><blockquote>
<p>vbScript 是个比较老的语言，这里只是玩下，建议还是用JS啦。。。。</p>
</blockquote>
<ul>
<li><p><strong>不用多说，创建一个.vbs文件，输入以下代码：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">NameSpace = &quot;http://schemas.microsoft.com/cdo/configuration/&quot;</div><div class="line">Set objEmail = CreateObject(&quot;CDO.Message&quot;)</div><div class="line">Call SendMail()</div><div class="line">Sub SendMail</div><div class="line">objEmail.BodyPart.Charset = &quot;gb2312&quot;</div><div class="line">objEmail.From = &quot;xxx@xxx.com&quot;</div><div class="line">objEmail.To = &quot;xxx@163.com&quot;</div><div class="line">objectEmail Cc=&quot;xxx@163.com&quot;//抄送</div><div class="line">objectEmail Bcc=&quot;xxx@163.com&quot;//密送</div><div class="line">objEmail.Subject = &quot;subject&quot;</div><div class="line">objEmail.Textbody = &quot;电子邮件内容&quot;</div><div class="line">objEmail.AddAttachment &quot;D:\NewTest\test.rar&quot;//附件</div><div class="line">objEmail.Configuration.Fields.Item (&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;) = 2</div><div class="line">objEmail.Configuration.Fields.Item (&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;) = &quot;smtp.exmail.qq.com&quot;</div><div class="line">objEmail.Configuration.Fields.Item (&quot;http://schemas.microsoft.com/cdo/configuration/sendusername&quot;) = &quot;你的用户名&quot;</div><div class="line">objEmail.Configuration.Fields.Item (&quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;) = &quot;密码&quot;</div><div class="line">objEmail.Configuration.Fields.Item (&quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;) = 1</div><div class="line">objEmail.Configuration.Fields.Item (&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;) = 25</div><div class="line">objEmail.Configuration.Fields.Update</div><div class="line">objEmail.Send</div><div class="line">End Sub</div></pre></td></tr></table></figure>
</li>
<li><p><strong>或者创建一个.bat文件，输入以下代码：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">echo set sh=WScript.CreateObject(&quot;WScript.Shell&quot;) &gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 300 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;open smtp.exmail.qq.com 25&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;helo abc&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;auth login&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;Y3pob3VAc2Zjc2VydmljZS5jb20=&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;U2ZjMTIz&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;mail from:&lt;xxx@xxx.com&gt;&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;rcpt to:&lt;xxx@qq.com&gt;&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;data&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo WScript.Sleep 100 &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;邮件主题!!!!&#123;ENTER&#125;&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;邮件内容!!!!&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">echo sh.SendKeys &quot;.&#123;ENTER&#125;&quot; &gt;&gt;telnet_tmp.vbs</div><div class="line">start telnet</div><div class="line">cscript //nologo telnet_tmp.vbs</div><div class="line">del telnet_tmp.vbs</div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>注意：以上登录telnet账号为<strong>base64</strong>转过后的（如：U2ZjMTIz）</p>
</blockquote>
<h3 id="三、Java发送邮件"><a href="#三、Java发送邮件" class="headerlink" title="三、Java发送邮件"></a>三、Java发送邮件</h3><p>　　<strong> 1）用spring</strong><br>　　上代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">package sendemail;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line">import java.util.Properties;</div><div class="line"></div><div class="line">import javax.mail.MessagingException;</div><div class="line"></div><div class="line">import org.springframework.mail.SimpleMailMessage;</div><div class="line">import org.springframework.mail.javamail.JavaMailSenderImpl;</div><div class="line"></div><div class="line">public class SendEmail &#123;</div><div class="line"></div><div class="line">public static void main(String args[]) throws MessagingException &#123;</div><div class="line">// SendEmail a = new SendEmail();</div><div class="line">// a.sendMail();</div><div class="line">sendMail();</div><div class="line">&#125;</div><div class="line"></div><div class="line">private static void sendMail() throws MessagingException &#123;</div><div class="line"></div><div class="line">JavaMailSenderImpl senderImpl = new JavaMailSenderImpl();</div><div class="line">// 设定mail server</div><div class="line">senderImpl.setHost(&quot;smtp.163.com&quot;);</div><div class="line">// 建立邮件消息</div><div class="line">SimpleMailMessage mailMessage = new SimpleMailMessage();</div><div class="line">// 设置收件人，寄件人 用数组发送多个邮件</div><div class="line">// String[] array = new String[] &#123;&quot;sun111@163.com&quot;,&quot;sun222@sohu.com&quot;&#125;;</div><div class="line">// mailMessage.setTo(array);</div><div class="line">mailMessage.setTo(&quot;xxx@qq.com&quot;);</div><div class="line">mailMessage.setFrom(&quot;xxx@163.com&quot;);</div><div class="line">mailMessage.setSubject(&quot; 测试简单文本邮件发送！ &quot;);</div><div class="line">mailMessage.setText(&quot; 测试我的简单邮件发送机制！！2222这是测试环境的代码 &quot; + new Date());</div><div class="line">mailMessage.setSentDate(new Date());</div><div class="line">senderImpl.setPort(25);</div><div class="line">senderImpl.setUsername(&quot;wuxin130&quot;); // 根据自己的情况,设置username</div><div class="line">senderImpl.setPassword(&quot;sss&quot;); // 根据自己的情况, 设置password</div><div class="line">senderImpl.setDefaultEncoding(&quot;UTF-8&quot;);</div><div class="line">Properties prop = new Properties();</div><div class="line">// prop.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;); //</div><div class="line">// 将这个参数设为true，让服务器进行认证,认证用户名和密码是否正确</div><div class="line">prop.put(&quot;mail.smtp.timeout&quot;, &quot;25000&quot;);</div><div class="line">prop.put(&quot;mail.debug&quot;, &quot;true&quot;);// 便于调试</div><div class="line">prop.put(&quot;mail.transport.protocol&quot;, &quot;smtp&quot;);</div><div class="line">/**</div><div class="line">* 关键代码， 出现554 DT:SPM 163 smtp5,D9GowACHO7RNWNdXmXs1Bw--.9035S2</div><div class="line">* 1473730639, please see</div><div class="line">* http://mail.163.com/help/help_spam_16.htm?ip=124.251.36.10</div><div class="line">* &amp;hostid=smtp5&amp;time=1473730639 原因是：ip与域名不匹配。</div><div class="line">*/</div><div class="line">prop.put(&quot;mail.smtp.localhost&quot;, &quot;mail.digu.com&quot;);</div><div class="line">prop.put(&quot;mail.smtp.auth&quot;, &quot;false&quot;);</div><div class="line">prop.put(&quot;mail.smtp.port&quot;, &quot;25&quot;);</div><div class="line">senderImpl.setJavaMailProperties(prop);</div><div class="line">// 发送邮件</div><div class="line"></div><div class="line">senderImpl.send(mailMessage);</div><div class="line"></div><div class="line">System.out.println(&quot; 邮件发送成功.. &quot;);</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>注意: 一定要导入<br>org.springframework.beans-3.0.5.RELEASE.jar<br>org.springframework.core-3.0.5.RELEASE.jar<br> mail.jar<br>spring-context-support-4.3.4.RELEASE.jar<br>四个jar包</p>
</blockquote>
<p><strong>2）<a href="http://blog.csdn.net/xietansheng/article/details/51722660" target="_blank" rel="external">基于JavaMail的Java邮件发送：复杂邮件发送</a></strong></p>
<blockquote>
<p>一封复杂的邮件内容可以看做是由很多节点（或者可以说是“片段”/“部分”/“零件”）组成，文本、图片、附件等都可以看成是邮件内容中的一个节点。这些节点之间又可以相互关联组合成一个节点。最终组合成一个大节点就是邮件的正文内容。<br>需要两个jar包：<br><strong>activation.jar<br>mail.jar   </strong>这个jar包一定用最新的，我用的1.4.7 成功了</p>
</blockquote>
<p>完整代码演示:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div></pre></td><td class="code"><pre><div class="line">package com.xiets.javamaildemo;</div><div class="line"></div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.util.Date;</div><div class="line">import java.util.Properties;</div><div class="line"></div><div class="line">import javax.activation.DataHandler;</div><div class="line">import javax.activation.FileDataSource;</div><div class="line">import javax.mail.Message.RecipientType;</div><div class="line">import javax.mail.Session;</div><div class="line">import javax.mail.Transport;</div><div class="line">import javax.mail.internet.InternetAddress;</div><div class="line">import javax.mail.internet.MimeBodyPart;</div><div class="line">import javax.mail.internet.MimeMessage;</div><div class="line">import javax.mail.internet.MimeMultipart;</div><div class="line">import javax.mail.internet.MimeUtility;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 创建并发送一封包含文本、图片、附件的复杂邮件</div><div class="line"> *</div><div class="line"> * @author xietansheng</div><div class="line"> */public class Main &#123;</div><div class="line"></div><div class="line">    // 发件人的 邮箱 和 密码（替换为自己的邮箱和密码）</div><div class="line">    public static String myEmailAccount = &quot;xxxxxxxx@163.com&quot;;</div><div class="line">    public static String myEmailPassword = &quot;xxxxxxxx&quot;;</div><div class="line"></div><div class="line">    // 发件人邮箱的 SMTP 服务器地址, 必须准确, 不同邮件服务器地址不同, 一般格式为: smtp.xxx.com</div><div class="line">    // 网易163邮箱的 SMTP 服务器地址为: smtp.163.com</div><div class="line">    public static String myEmailSMTPHost = &quot;smtp.163.com&quot;;</div><div class="line"></div><div class="line">    // 收件人邮箱（替换为自己知道的有效邮箱）</div><div class="line">    public static String receiveMailAccount = &quot;xiejava@qq.com&quot;;</div><div class="line"></div><div class="line">    public static void main(String[] args) throws Exception &#123;</div><div class="line">        // 1. 创建参数配置, 用于连接邮件服务器的参数配置</div><div class="line">        Properties props = new Properties();                    // 参数配置</div><div class="line">        props.setProperty(&quot;mail.transport.protocol&quot;, &quot;smtp&quot;);   // 使用的协议（JavaMail规范要求）</div><div class="line">        props.setProperty(&quot;mail.smtp.host&quot;, myEmailSMTPHost);   // 发件人的邮箱的 SMTP 服务器地址</div><div class="line">        props.setProperty(&quot;mail.smtp.auth&quot;, &quot;true&quot;);            // 需要请求认证</div><div class="line"></div><div class="line">        // 开启 SSL 连接, 以及更详细的发送步骤请看上一篇: 基于 JavaMail 的 Java 邮件发送：简单邮件发送</div><div class="line"></div><div class="line">        // 2. 根据配置创建会话对象, 用于和邮件服务器交互</div><div class="line">        Session session = Session.getDefaultInstance(props);</div><div class="line">        session.setDebug(true);                                 // 设置为debug模式, 可以查看详细的发送 log</div><div class="line"></div><div class="line">        // 3. 创建一封邮件</div><div class="line">        MimeMessage message = createMimeMessage(session, myEmailAccount, receiveMailAccount);</div><div class="line"></div><div class="line">        // 也可以保持到本地查看</div><div class="line">        // message.writeTo(file_out_put_stream);</div><div class="line"></div><div class="line">        // 4. 根据 Session 获取邮件传输对象</div><div class="line">        Transport transport = session.getTransport();</div><div class="line"></div><div class="line">        // 5. 使用 邮箱账号 和 密码 连接邮件服务器</div><div class="line">        //    这里认证的邮箱必须与 message 中的发件人邮箱一致，否则报错</div><div class="line">        transport.connect(myEmailAccount, myEmailPassword);</div><div class="line"></div><div class="line">        // 6. 发送邮件, 发到所有的收件地址, message.getAllRecipients() 获取到的是在创建邮件对象时添加的所有收件人, 抄送人, 密送人</div><div class="line">        transport.sendMessage(message, message.getAllRecipients());</div><div class="line"></div><div class="line">        // 7. 关闭连接</div><div class="line">        transport.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 创建一封复杂邮件（文本+图片+附件）</div><div class="line">     */</div><div class="line">    public static MimeMessage createMimeMessage(Session session, String sendMail, String receiveMail) throws Exception &#123;</div><div class="line">        // 1. 创建邮件对象</div><div class="line">        MimeMessage message = new MimeMessage(session);</div><div class="line"></div><div class="line">        // 2. From: 发件人</div><div class="line">        message.setFrom(new InternetAddress(sendMail, &quot;我的测试邮件_发件人昵称&quot;, &quot;UTF-8&quot;));</div><div class="line"></div><div class="line">        // 3. To: 收件人（可以增加多个收件人、抄送、密送）</div><div class="line">        message.addRecipient(RecipientType.TO, new InternetAddress(receiveMail, &quot;我的测试邮件_收件人昵称&quot;, &quot;UTF-8&quot;));</div><div class="line"></div><div class="line">        // 4. Subject: 邮件主题</div><div class="line">        message.setSubject(&quot;TEST邮件主题（文本+图片+附件）&quot;, &quot;UTF-8&quot;);</div><div class="line"></div><div class="line">        /*</div><div class="line">         * 下面是邮件内容的创建:</div><div class="line">         */</div><div class="line"></div><div class="line">        // 5. 创建图片“节点”</div><div class="line">        MimeBodyPart image = new MimeBodyPart();</div><div class="line">        DataHandler dh = new DataHandler(new FileDataSource(&quot;FairyTail.jpg&quot;)); // 读取本地文件</div><div class="line">        image.setDataHandler(dh);                   // 将图片数据添加到“节点”</div><div class="line">        image.setContentID(&quot;image_fairy_tail&quot;);     // 为“节点”设置一个唯一编号（在文本“节点”将引用该ID）</div><div class="line"></div><div class="line">        // 6. 创建文本“节点”</div><div class="line">        MimeBodyPart text = new MimeBodyPart();</div><div class="line">        //    这里添加图片的方式是将整个图片包含到邮件内容中, 实际上也可以以 http 链接的形式添加网络图片</div><div class="line">        text.setContent(&quot;这是一张图片&lt;br/&gt;&lt;img src=&apos;cid:image_fairy_tail&apos;/&gt;&quot;, &quot;text/html;charset=UTF-8&quot;);</div><div class="line"></div><div class="line">        // 7. （文本+图片）设置 文本 和 图片 “节点”的关系（将 文本 和 图片 “节点”合成一个混合“节点”）</div><div class="line">        MimeMultipart mm_text_image = new MimeMultipart();</div><div class="line">        mm_text_image.addBodyPart(text);</div><div class="line">        mm_text_image.addBodyPart(image);</div><div class="line">        mm_text_image.setSubType(&quot;related&quot;);    // 关联关系</div><div class="line"></div><div class="line">        // 8. 将 文本+图片 的混合“节点”封装成一个普通“节点”</div><div class="line">        //    最终添加到邮件的 Content 是由多个 BodyPart 组成的 Multipart, 所以我们需要的是 BodyPart,</div><div class="line">        //    上面的 mm_text_image 并非 BodyPart, 所有要把 mm_text_image 封装成一个 BodyPart</div><div class="line">        MimeBodyPart text_image = new MimeBodyPart();</div><div class="line">        text_image.setContent(mm_text_image);</div><div class="line"></div><div class="line">        // 9. 创建附件“节点”</div><div class="line">        MimeBodyPart attachment = new MimeBodyPart();</div><div class="line">        DataHandler dh2 = new DataHandler(new FileDataSource(&quot;妖精的尾巴目录.doc&quot;));  // 读取本地文件</div><div class="line">        attachment.setDataHandler(dh2);                                             // 将附件数据添加到“节点”</div><div class="line">        attachment.setFileName(MimeUtility.encodeText(dh2.getName()));              // 设置附件的文件名（需要编码）</div><div class="line"></div><div class="line">        // 10. 设置（文本+图片）和 附件 的关系（合成一个大的混合“节点” / Multipart ）</div><div class="line">        MimeMultipart mm = new MimeMultipart();</div><div class="line">        mm.addBodyPart(text_image);</div><div class="line">        mm.addBodyPart(attachment);     // 如果有多个附件，可以创建多个多次添加</div><div class="line">        mm.setSubType(&quot;mixed&quot;);         // 混合关系</div><div class="line"></div><div class="line">        // 11. 设置整个邮件的关系（将最终的混合“节点”作为邮件的内容添加到邮件对象）</div><div class="line">        message.setContent(mm);</div><div class="line"></div><div class="line">        // 12. 设置发件时间</div><div class="line">        message.setSentDate(new Date());</div><div class="line"></div><div class="line">        // 13. 保存上面的所有设置</div><div class="line">        message.saveChanges();</div><div class="line"></div><div class="line">        return message;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>如果只是想发送文本和附件，参考一下代码:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line">package com.sendemail;</div><div class="line">import java.util.Date;</div><div class="line">import java.util.Properties;</div><div class="line">import javax.activation.DataHandler;</div><div class="line">import javax.activation.FileDataSource;</div><div class="line">import javax.mail.Session;</div><div class="line">import javax.mail.Transport;</div><div class="line">import javax.mail.internet.InternetAddress;</div><div class="line">import javax.mail.internet.MimeBodyPart;</div><div class="line">import javax.mail.internet.MimeMessage;</div><div class="line">import javax.mail.internet.MimeMessage.RecipientType;</div><div class="line">import javax.mail.internet.MimeMultipart;</div><div class="line">import javax.mail.internet.MimeUtility;</div><div class="line">public class SendEmail2 &#123;</div><div class="line">     // 发件人的 邮箱 和 密码（替换为自己的邮箱和密码）</div><div class="line">     public static String myEmailAccount = &quot;xxx@xxx.com&quot;;</div><div class="line">     public static String myEmailPassword = &quot;*********&quot;;</div><div class="line">     // 发件人邮箱的 SMTP 服务器地址, 必须准确, 不同邮件服务器地址不同, 一般格式为: smtp.xxx.com</div><div class="line">     // 网易163邮箱的 SMTP 服务器地址为: smtp.163.com</div><div class="line">     public static String myEmailSMTPHost = &quot;smtp.exmail.qq.com&quot;;</div><div class="line">     // 收件人邮箱（替换为自己知道的有效邮箱）</div><div class="line">     public static String receiveMailAccount = &quot;xxx@qq.com&quot;;</div><div class="line">     // 收件人邮箱（替换为自己知道的有效邮箱）</div><div class="line">     public static String receiveMailCcAccount = &quot;13026162269@163.com&quot;;</div><div class="line">     public static void main(String[] args) throws Exception &#123;</div><div class="line">          // 1. 创建参数配置, 用于连接邮件服务器的参数配置</div><div class="line">          Properties props = new Properties(); // 参数配置</div><div class="line">          props.setProperty(&quot;mail.transport.protocol&quot;, &quot;smtp&quot;); // 使用的协议（JavaMail规范要求）</div><div class="line">          props.setProperty(&quot;mail.smtp.host&quot;, myEmailSMTPHost); // 发件人的邮箱的 SMTP</div><div class="line">                                                                             // 服务器地址</div><div class="line">          props.setProperty(&quot;mail.smtp.auth&quot;, &quot;true&quot;); // 需要请求认证</div><div class="line">          // 开启 SSL 连接, 以及更详细的发送步骤请看上一篇: 基于 JavaMail 的 Java 邮件发送：简单邮件发送</div><div class="line">          // 2. 根据配置创建会话对象, 用于和邮件服务器交互</div><div class="line">          Session session = Session.getDefaultInstance(props);</div><div class="line">          session.setDebug(true); // 设置为debug模式, 可以查看详细的发送 log</div><div class="line">          // 3. 创建一封邮件</div><div class="line">          MimeMessage message = createMimeMessage(session, myEmailAccount,</div><div class="line">                   receiveMailAccount, receiveMailCcAccount);</div><div class="line">          // 也可以保持到本地查看</div><div class="line">          // message.writeTo(file_out_put_stream);</div><div class="line">          // 4. 根据 Session 获取邮件传输对象</div><div class="line">          Transport transport = session.getTransport();</div><div class="line">          // 5. 使用 邮箱账号 和 密码 连接邮件服务器</div><div class="line">          // 这里认证的邮箱必须与 message 中的发件人邮箱一致，否则报错</div><div class="line">          transport.connect(myEmailAccount, myEmailPassword);</div><div class="line">          // 6. 发送邮件, 发到所有的收件地址, message.getAllRecipients() 获取到的是在创建邮件对象时添加的所有收件人,</div><div class="line">          // 抄送人, 密送人</div><div class="line">          transport.sendMessage(message, message.getAllRecipients());</div><div class="line">          // 7. 关闭连接</div><div class="line">          transport.close();</div><div class="line">     &#125;</div><div class="line">     /**</div><div class="line">      * 创建一封复杂邮件（文本+图片+附件）</div><div class="line">      */</div><div class="line">     public static MimeMessage createMimeMessage(Session session,</div><div class="line">              String sendMail, String receiveMail, String receiveMailCc)</div><div class="line">              throws Exception &#123;</div><div class="line">          // 1. 创建邮件对象</div><div class="line">          MimeMessage message = new MimeMessage(session);</div><div class="line">          // 2. From: 发件人</div><div class="line">          message.setFrom(new InternetAddress(sendMail, &quot;t-mac&quot;, &quot;UTF-8&quot;));</div><div class="line">          // 3. To: 收件人（可以增加多个收件人、抄送、密送）</div><div class="line">          message.addRecipient(RecipientType.TO, new InternetAddress(receiveMail,</div><div class="line">                   &quot;yao&quot;, &quot;UTF-8&quot;));</div><div class="line">          message.addRecipient(RecipientType.CC, new InternetAddress(</div><div class="line">                   receiveMailCc, &quot;yaoming&quot;, &quot;UTF-8&quot;));</div><div class="line">          // 4. Subject: 邮件主题</div><div class="line">          message.setSubject(&quot;TEST邮件主题（文本+图片+附件）&quot;, &quot;UTF-8&quot;);</div><div class="line">         // 添加文本</div><div class="line">          MimeBodyPart htmlPart = new MimeBodyPart();</div><div class="line">          htmlPart.setContent( &quot;hahahahh&quot;,&quot;text/html;charset=UTF-8&quot;);</div><div class="line">          /*</div><div class="line">           * 下面是邮件内容的创建:</div><div class="line">           */</div><div class="line">          // 9. 创建附件“节点”</div><div class="line">          MimeBodyPart attachment = new MimeBodyPart();</div><div class="line">          DataHandler dh2 = new DataHandler(new FileDataSource(</div><div class="line">                   &quot;E:\\test\\NewTest\\Download.CSV&quot;)); // 读取本地文件</div><div class="line">          attachment.setDataHandler(dh2); // 将附件数据添加到“节点”</div><div class="line">          attachment.setFileName(MimeUtility.encodeText(dh2.getName())); // 设置附件的文件名（需要编码）</div><div class="line">          // 10. 设置（文本+图片）和 附件 的关系（合成一个大的混合“节点” / Multipart ）</div><div class="line">          MimeMultipart mm = new MimeMultipart();</div><div class="line">           mm.addBodyPart(htmlPart);</div><div class="line">          mm.addBodyPart(attachment); // 如果有多个附件，可以创建多个多次添加</div><div class="line">          mm.setSubType(&quot;mixed&quot;); // 混合关系</div><div class="line">          // 11. 设置整个邮件的关系（将最终的混合“节点”作为邮件的内容添加到邮件对象）</div><div class="line">          message.setContent(mm);</div><div class="line">          // 12. 设置发件时间</div><div class="line">          message.setSentDate(new Date());</div><div class="line">         // message.setText(&quot;保存上面的所有设置&quot;);// 设置文本内容</div><div class="line">          // 13. 保存上面的所有设置</div><div class="line">          message.saveChanges();</div><div class="line">          return message;</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="四、Python发送邮件"><a href="#四、Python发送邮件" class="headerlink" title="四、Python发送邮件"></a>四、Python发送邮件</h3><blockquote>
<p>终于来到了Python，不多说，直接上代码：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"># -*- coding: utf-8 -*-</div><div class="line"></div><div class="line">&apos;&apos;&apos;</div><div class="line">发送邮件</div><div class="line">&apos;&apos;&apos;</div><div class="line"></div><div class="line">import smtplib</div><div class="line">from email.mime.base import MIMEBase</div><div class="line">from email.mime.multipart import MIMEMultipart</div><div class="line">from email.mime.text import MIMEText</div><div class="line">import os.path</div><div class="line">import email</div><div class="line">import mimetypes</div><div class="line">import os</div><div class="line">from os.path import join, getsize</div><div class="line">import traceback</div><div class="line"></div><div class="line">class EmailManager:</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    send email to the given email address automatically</div><div class="line">    &apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __init__(self, **kw):</div><div class="line">        &apos; 构造函数 &apos;</div><div class="line">        self.kw = kw</div><div class="line"></div><div class="line">        # self.smtp_server = &quot;smtp.exmail.qq.com&quot;</div><div class="line">        self.MAX_FILE_SIZE = 10 * 1024 * 1024  # 10M</div><div class="line"></div><div class="line">    def run(self):</div><div class="line">        # 总入口</div><div class="line">        try:</div><div class="line">            # 初始化</div><div class="line">            self.__my_init()</div><div class="line">            # 登录SMTP服务器，验证授权</div><div class="line">            server = self.get_login_server()</div><div class="line">            # 生成邮件主体内容</div><div class="line">            main_msg = self.get_main_msg()</div><div class="line">            # 生成邮件附件内容</div><div class="line">            file_msg = self.get_attach_file_msg()</div><div class="line"></div><div class="line">            if file_msg is not None:</div><div class="line">                main_msg.attach(file_msg)</div><div class="line"></div><div class="line">            # 得到格式化后的完整文本</div><div class="line">            fullText = main_msg.as_string()</div><div class="line"></div><div class="line">            # 发送邮件</div><div class="line">            server.sendmail(self.msg_from, self.receiver, fullText)</div><div class="line">        except Exception as e:</div><div class="line">            print(e)</div><div class="line">            exstr = traceback.format_exc()</div><div class="line">            print(exstr)</div><div class="line">            server.quit()</div><div class="line">            exit()</div><div class="line"></div><div class="line">    def get_main_msg(self):</div><div class="line">        &apos; 生成邮件主体内容 &apos;</div><div class="line">        # 构造MIMEMultipart对象做为根容器</div><div class="line">        main_msg = MIMEMultipart()</div><div class="line"></div><div class="line">        # 构造MIMEText对象做为邮件显示内容并附加到根容器</div><div class="line">        text_msg = MIMEText(self.msg_content, _charset=&quot;utf-8&quot;)</div><div class="line">        main_msg.attach(text_msg)</div><div class="line"></div><div class="line">        # 设置根容器属性</div><div class="line">        main_msg[&apos;From&apos;] = self.msg_from</div><div class="line">        main_msg[&apos;To&apos;] = self.msg_to</div><div class="line">        main_msg[&apos;Cc&apos;] = self.msg_cc</div><div class="line">        main_msg[&apos;Subject&apos;] = self.msg_subject</div><div class="line">        main_msg[&apos;Date&apos;] = self.msg_date</div><div class="line"></div><div class="line">        return main_msg</div><div class="line"></div><div class="line">    def get_attach_file_msg(self):</div><div class="line">        &apos; 生成邮件附件内容 &apos;</div><div class="line">        if self.attach_file is not None and self.attach_file != &quot;&quot;:</div><div class="line">            try:</div><div class="line">                self.validate_file_size()</div><div class="line"></div><div class="line">                data = open(self.attach_file, &apos;rb&apos;)</div><div class="line">                ctype, encoding = mimetypes.guess_type(self.attach_file)</div><div class="line">                if ctype is None or encoding is not None:</div><div class="line">                    ctype = &apos;application/octet-stream&apos;</div><div class="line">                maintype, subtype = ctype.split(&apos;/&apos;, 1)</div><div class="line">                file_msg = MIMEBase(maintype, subtype)</div><div class="line">                file_msg.set_payload(data.read())</div><div class="line">                data.close()</div><div class="line"></div><div class="line">                email.encoders.encode_base64(file_msg)  # 把附件编码</div><div class="line"></div><div class="line">                ## 设置附件头</div><div class="line">                basename = os.path.basename(self.attach_file)</div><div class="line">                file_msg.add_header(&apos;Content-Disposition&apos;, &apos;attachment&apos;, filename=basename)  # 修改邮件头</div><div class="line"></div><div class="line">                return file_msg</div><div class="line">            except Exception as e:</div><div class="line">                print(e)</div><div class="line">                return None</div><div class="line"></div><div class="line">        else:</div><div class="line">            return None</div><div class="line"></div><div class="line">    def get_login_server(self):</div><div class="line">        &apos; 登录SMTP服务器，验证授权信息 &apos;</div><div class="line">        server = smtplib.SMTP(self.smtp_server)</div><div class="line">        server.login(self.server_username, self.server_pwd)  # 仅smtp服务器需要验证时</div><div class="line"></div><div class="line">        return server</div><div class="line"></div><div class="line">    def validate_file_size(self):</div><div class="line">        &apos; 验证文件大小是否合法 &apos;</div><div class="line">        if getsize(self.attach_file) &gt; self.MAX_FILE_SIZE:</div><div class="line">            raise Exception(u&apos;附件过大，上传失败&apos;)</div><div class="line"></div><div class="line">    def __my_init(self):</div><div class="line">        &apos; 配置初始化 &apos;</div><div class="line">        # 邮箱登录设置</div><div class="line">        self.smtp_server = self.__get_cfg(&apos;smtp_server&apos;)</div><div class="line">        self.server_username = self.__get_cfg(&apos;server_username&apos;)</div><div class="line">        self.server_pwd = self.__get_cfg(&apos;server_pwd&apos;)</div><div class="line"></div><div class="line">        # 邮件内容设置</div><div class="line">        self.receiver = self.__get_cfg(&apos;msg_to&apos;) + self.__get_cfg(&apos;msg_cc&apos;)</div><div class="line"></div><div class="line">        self.msg_from = self.server_username</div><div class="line">        self.msg_to = &apos;,&apos;.join(self.__get_cfg(&apos;msg_to&apos;))</div><div class="line">        self.msg_cc = &apos;,&apos;.join(self.__get_cfg(&apos;msg_cc&apos;))</div><div class="line">        self.msg_subject = self.__get_cfg(&apos;msg_subject&apos;)</div><div class="line">        self.msg_date = self.__get_cfg(&apos;msg_date&apos;)</div><div class="line">        print(self.msg_date)</div><div class="line">        self.msg_content = self.__get_cfg(&apos;msg_content&apos;)</div><div class="line"></div><div class="line">        # 附件</div><div class="line">        self.attach_file = self.__get_cfg(&apos;attach_file&apos;, throw=False)</div><div class="line"></div><div class="line">    def __get_cfg(self, key, throw=True):</div><div class="line">        &apos; 根据key从**kw中取得相应的配置内容 &apos;</div><div class="line">        cfg = self.kw.get(key)</div><div class="line">        if throw == True and (cfg is None or cfg == &apos;&apos;):</div><div class="line">            raise Exception(&quot;配置不能为空！&quot;.decode(&apos;utf-8&apos;))</div><div class="line"></div><div class="line">        return cfg</div><div class="line">以下为调用代码：</div><div class="line"></div><div class="line">mail_cfg = &#123;</div><div class="line">    # 邮箱登录设置，使用SMTP登录</div><div class="line">    &apos;server_username&apos;: &apos;czhou@sfcservice.com&apos;,</div><div class="line">    &apos;server_pwd&apos;: &apos;密码&apos;,</div><div class="line">    &apos;smtp_server&apos;: &apos;smtp.exmail.qq.com&apos;,</div><div class="line">    # 邮件内容设置</div><div class="line">    &apos;msg_to&apos;: [&apos;czhou@sfcservice.com&apos;],  # 可以在此添加收件人,一定要list类型</div><div class="line">    &apos;msg_cc&apos;: [&apos;zone_c@qq.com&apos;, &apos;13026162269@163.com&apos;],</div><div class="line">    &apos;msg_subject&apos;: u&apos;代码&apos;,</div><div class="line">    &apos;msg_date&apos;: time.strftime(&apos;%Y-%m-%d %X&apos;, time.localtime()),</div><div class="line">    &apos;msg_content&apos;: u&quot;我的备份&quot;,</div><div class="line"></div><div class="line">    # 附件</div><div class="line">    &apos;attach_file&apos;: &apos;E:\\test\\NewTest\\test.txt&apos;</div><div class="line">&#125;</div><div class="line"># print( time.strftime(&apos;%Y-%m-%d %X&apos;, time.localtime()))</div><div class="line">email_manager = EmailManager(**mail_cfg)</div><div class="line"></div><div class="line">email_manager.run()</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://zonectmac.com/2016/09/03/hexo-test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZonecTmac">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="信笺叶子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/03/hexo-test/" itemprop="url">
                  测试文章
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-03T21:59:10+08:00">
                2016-09-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/测试/" itemprop="url" rel="index">
                    <span itemprop="name">测试</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="biaoti"><a href="#biaoti" class="headerlink" title="biaoti"></a>biaoti</h1><h3 id="baagaagar"><a href="#baagaagar" class="headerlink" title="baagaagar"></a>baagaagar</h3>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://zonectmac.com/2016/09/01/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZonecTmac">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="信笺叶子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/01/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-01T23:51:37+08:00">
                2016-09-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="ZonecTmac" />
          <p class="site-author-name" itemprop="name">ZonecTmac</p>
           
              <p class="site-description motion-element" itemprop="description">zonectmac 博客</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zonectmac" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZonecTmac</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



  

  

  

  

</body>
</html>
